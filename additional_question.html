<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parliament</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="wrapper">
        <div class="header">
            <div class="container">
                <div class="logo">
                    <img src="img/logo.png" alt="logotype">
                </div>
                <div class="nav">
                    <ul>
                        <li><a href="#/">Все о продуктах</a></li>
                    </ul>
                </div>
                <div class="profile">
                    <div class="dropdown">
                        <input id="profilemenu" type="checkbox">
                        <label for="profilemenu">
                            <div class="icon-burger">
                                <div class="line-holder">
                                    <div class="line"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                            <span>Виктория</span>
                        </label>
                        <div class="toggle-list">
                            <div class="nav">
                                <ul>
                                    <li><a href="#/">Все о продуктах</a></li>
                                </ul>
                            </div>
                            <ul>
                                <li><a href="#/">Профиль</a></li>
                                <li><a href="#/">Выйти</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="main">
            <div class="wide-container">
                <div class="survey">
                    <div class="slide slide-1 active">
                        <div class="slide-holder">
                            <div class="question">
                                <h2>Оцените письма, которые Вы&nbsp;получали с&nbsp;коммуникацией про<br>
                                    «Избранную коллекцию фактов, советов и&nbsp;полезных лайфхаков»<br>
                                    по&nbsp;шкале от&nbsp;1&nbsp;до&nbsp;5</h2>
                            </div>
                            <div class="answers">
                                <div class="answer">
                                    <input id="q1-a1" type="radio" name="q1">
                                    <div class="radio-btn"></div>
                                    <label for="q1-a1">1</label>
                                </div>
                                <div class="answer">
                                    <input id="q1-a2" type="radio" name="q1">
                                    <div class="radio-btn"></div>
                                    <label for="q1-a2">2</label>
                                </div>
                                <div class="answer">
                                    <input id="q1-a3" type="radio" name="q1">
                                    <div class="radio-btn"></div>
                                    <label for="q1-a3">3</label>
                                </div>
                                <div class="answer">
                                    <input id="q1-a4" type="radio" name="q1">
                                    <div class="radio-btn"></div>
                                    <label for="q1-a4">4</label>
                                </div>
                                <div class="answer">
                                    <input id="q1-a5" type="radio" name="q1">
                                    <div class="radio-btn"></div>
                                    <label for="q1-a5">5</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide slide-2">
                        <div class="slide-holder">
                            <div class="question">
                                <h2>Какая тема была для&nbsp;Вас более интересна
                                    <small>
                                        (оцените каждую по&nbsp;шкале от&nbsp;1&nbsp;до&nbsp;5​)
                                    </small>
                                </h2>
                            </div>
                            <div class="subquestion-items">
                                <div class="subquestion-item">
                                    <h2 class="subquestion">Интересные факты</h2>
                                    <div class="answers">
                                        <div class="answer">
                                            <input id="q2-a1" type="radio" name="q2">
                                            <div class="radio-btn"></div>
                                            <label for="q2-a1">1</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q2-a2" type="radio" name="q2">
                                            <div class="radio-btn"></div>
                                            <label for="q2-a2">2</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q2-a3" type="radio" name="q2">
                                            <div class="radio-btn"></div>
                                            <label for="q2-a3">3</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q2-a4" type="radio" name="q2">
                                            <div class="radio-btn"></div>
                                            <label for="q2-a4">4</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q2-a5" type="radio" name="q2">
                                            <div class="radio-btn"></div>
                                            <label for="q2-a5">5</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="subquestion-item">
                                    <h2 class="subquestion">Полезные лайфхаки</h2>
                                    <div class="answers">
                                        <div class="answer">
                                            <input id="q3-a1" type="radio" name="q3">
                                            <div class="radio-btn"></div>
                                            <label for="q3-a1">1</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q3-a2" type="radio" name="q3">
                                            <div class="radio-btn"></div>
                                            <label for="q3-a2">2</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q3-a3" type="radio" name="q3">
                                            <div class="radio-btn"></div>
                                            <label for="q3-a3">3</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q3-a4" type="radio" name="q3">
                                            <div class="radio-btn"></div>
                                            <label for="q3-a4">4</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q3-a5" type="radio" name="q3">
                                            <div class="radio-btn"></div>
                                            <label for="q3-a5">5</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="subquestion-item">
                                    <h2 class="subquestion">Бизнес советы</h2>
                                    <div class="answers">
                                        <div class="answer">
                                            <input id="q4-a1" type="radio" name="q4">
                                            <div class="radio-btn"></div>
                                            <label for="q4-a1">1</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q4-a2" type="radio" name="q4">
                                            <div class="radio-btn"></div>
                                            <label for="q4-a2">2</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q4-a3" type="radio" name="q4">
                                            <div class="radio-btn"></div>
                                            <label for="q4-a3">3</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q4-a4" type="radio" name="q4">
                                            <div class="radio-btn"></div>
                                            <label for="q4-a4">4</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q4-a5" type="radio" name="q4">
                                            <div class="radio-btn"></div>
                                            <label for="q4-a5">5</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="subquestion-item">
                                    <h2 class="subquestion">Ничего из&nbsp;перечисленного</h2>
                                    <div class="answers">
                                        <div class="answer">
                                            <input id="q5-a1" type="radio" name="q5">
                                            <div class="radio-btn"></div>
                                            <label for="q5-a1">1</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q5-a2" type="radio" name="q5">
                                            <div class="radio-btn"></div>
                                            <label for="q5-a2">2</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q5-a3" type="radio" name="q5">
                                            <div class="radio-btn"></div>
                                            <label for="q5-a3">3</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q5-a4" type="radio" name="q5">
                                            <div class="radio-btn"></div>
                                            <label for="q5-a4">4</label>
                                        </div>
                                        <div class="answer">
                                            <input id="q5-a5" type="radio" name="q5">
                                            <div class="radio-btn"></div>
                                            <label for="q5-a5">5</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide slide-3">
                        <div class="slide-holder">
                            <div class="question">
                                <h2>Вы&nbsp;открыли только одно письмо из&nbsp;нашей серии писем. Почему?</h2>
                            </div>
                            <div class="answers answers-horizontal">
                                <div class="answer">
                                    <input id="q6-a1" type="radio" name="q6">
                                    <div class="radio-btn"></div>
                                    <label for="q6-a1">Не&nbsp;было понятно, что&nbsp;были еще&nbsp;другие</label>
                                </div>
                                <div class="answer">
                                    <input id="q6-a2" type="radio" name="q6">
                                    <div class="radio-btn"></div>
                                    <label for="q6-a2">Не&nbsp;интересно</label>
                                </div>
                                <div class="answer">
                                    <input id="q6-a3" type="radio" name="q6">
                                    <div class="radio-btn"></div>
                                    <label for="q6-a3">Первое письмо открыл случайно</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide slide-4">
                        <div class="slide-holder">
                            <div class="question">
                                <h2>Как Вы&nbsp;относитесь к&nbsp;идее регулярно (раз в&nbsp;неделю)<br> 
                                    получать интересные факты, советы, лайфхаки?
                                    <small>
                                        (Оцените по&nbsp;шкале от&nbsp;1 (отрицательно) до&nbsp;5&nbsp;(положительно))
                                    </small>
                                </h2>
                            </div>
                            <div class="answers">
                                <div class="answer">
                                    <input id="q7-a1" type="radio" name="q7">
                                    <div class="radio-btn"></div>
                                    <label for="q7-a1">1</label>
                                </div>
                                <div class="answer">
                                    <input id="q7-a2" type="radio" name="q7">
                                    <div class="radio-btn"></div>
                                    <label for="q7-a2">2</label>
                                </div>
                                <div class="answer">
                                    <input id="q7-a3" type="radio" name="q7">
                                    <div class="radio-btn"></div>
                                    <label for="q7-a3">3</label>
                                </div>
                                <div class="answer">
                                    <input id="q7-a4" type="radio" name="q7">
                                    <div class="radio-btn"></div>
                                    <label for="q7-a4">4</label>
                                </div>
                                <div class="answer">
                                    <input id="q7-a5" type="radio" name="q7">
                                    <div class="radio-btn"></div>
                                    <label for="q7-a5">5</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide slide-5">
                        <div class="slide-holder">
                            <div class="question">
                                <h2>Вы&nbsp;сканировали&nbsp;/ cканируете <nobr>QR-код</nobr> на&nbsp;пачках сигарет?</h2>
                            </div>
                            <div class="answers answers-horizontal two-cols">
                                <div class="answer">
                                    <input id="q8-a1" type="radio" name="q8">
                                    <div class="radio-btn"></div>
                                    <label for="q8-a1">Каждый день</label>
                                </div>
                                <div class="answer">
                                    <input id="q8-a2" type="radio" name="q8">
                                    <div class="radio-btn"></div>
                                    <label for="q8-a2">Раз в&nbsp;2 недели</label>
                                </div>
                                <div class="answer">
                                    <input id="q8-a3" type="radio" name="q8">
                                    <div class="radio-btn"></div>
                                    <label for="q8-a3">Раз в&nbsp;неделю</label>
                                </div>
                                <div class="answer">
                                    <input id="q8-a4" type="radio" name="q8">
                                    <div class="radio-btn"></div>
                                    <label for="q8-a4">Никогда</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide slide-6">
                        <div class="slide-holder">
                            <div class="question">
                                <h2>Удобно&nbsp;ли Вам&nbsp;узнавать информацию от&nbsp;бренда<br>
                                    через QR-код на&nbsp;пачке?</h2>
                            </div>
                            <div class="answers answers-horizontal two-cols-inline">
                                <div class="answer">
                                    <input id="q9-a1" type="radio" name="q9">
                                    <div class="radio-btn"></div>
                                    <label for="q9-a1">Да</label>
                                </div>
                                <div class="answer">
                                    <input id="q9-a2" type="radio" name="q9">
                                    <div class="radio-btn"></div>
                                    <label for="q9-a2">Нет</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slide slide-7">
                        <div class="slide-holder finish">
                            <h3>Имя,</h3>
                            <span>спасибо, что&nbsp;приняли участие в&nbsp;опросе!</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer">
            <div>
                <span>Курение убивает</span>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const answers = new Object;
            const options = document.querySelectorAll(".answers input[type=radio]");
            const slides = document.querySelectorAll(".slide");
            const active = 'active';
            let curr = 0;

            const nextSlide = () => {
                slides[curr].classList.remove(active);
                slides[++curr].classList.add(active);
            }

            const sendRequest = (method, url, params = null) => {
                return new Promise((resolve, reject) => {
                const xhr = new XMLHttpRequest();
                xhr.open(method, url);
                xhr.responseType = 'json';
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.onload = () => {
                    xhr.status > 400
                        ? reject(xhr.onerror)
                        : resolve(xhr.response);
                }
                xhr.onerror = () => reject(xhr.onerror);

                xhr.send(JSON.stringify(params));
                });
            }

            const sendData = () => {
                const requestURL = "%%=CloudPagesURL(1620,'Id',@id,'utm_source',@utm_source,'utm_medium',@utm_medium,'utm_campaign',@utm_campaign,'landing_name',@landing_name)=%%";

                sendRequest('POST', requestURL, answers)
                    .then((data) => {
                    console.log(data)
                    })
                    .catch((error) => {
                    console.log(error)
                });
            }

            const radioChangeHandler = (e) => {
                const optLabel = document.querySelector('label[for='+e.target.id+']');
                const currAnswers = slides[curr].querySelectorAll('.answers')
                const currRadioChecked = slides[curr].querySelectorAll('input[type=radio]:checked')

                answers[e.target.name] = optLabel.innerHTML;
                
                if(currRadioChecked.length != currAnswers.length) return false

                curr < slides.length-2
                    ? nextSlide()
                    : (nextSlide(), sendData());
            }

            options.forEach(item => item.addEventListener('change', radioChangeHandler));
        });
    </script>
</body>
</html>